<%- include('../../common/adminheader.ejs') %>
<script type="text/javascript" src="/node_modules/jquery/dist/jquery.js"></script>
<title>구축실적 수정 페이지 - 테스트용 사이트</title>

<div class="admin_body">
    <div class="admin_content">
        <div class="admin_contentwrap">
            <h1>구축실적 추가</h1>          
            <form method="POST" enctype="multipart/form-data", action="/portfolio_create" onsubmit="return contentsCheck();">
                <div class="write_table">
                    <div class="write_table_div">
                        <div class="write_table_div1">
                            <span>고객사명</span>
                        </div>
                        <div class="write_table_div2">
                            <input type="text" id="customer" name="customer" value="">
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="message_table_div">
                        <div class="message_table_div1">
                        
                        </div>
                        <div class="message_table_div2">
                            <span id="customerMessage">※ 고객사명을 입력해주세요.</span>
                        </div>
                        <div class="message_table_div3">
                        
                        </div>
                    </div>
                    <div class="write_table_div">
                        <div class="write_table_div1">
                            <span>프로젝트명</span>
                        </div>
                        <div class="write_table_div2">
                            <input type="text" id="project" name="project" value="">
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="message_table_div">
                        <div class="message_table_div1">
                        
                        </div>
                        <div class="message_table_div2">
                            <span id="projectMessage">※ 프로젝트명을 입력해주세요.</span>
                        </div>
                        <div class="message_table_div3">
                        
                        </div>
                    </div>
                    <div class="write_table_div">
                        <div class="write_table_div1">
                            <span>시작월</span>
                        </div>
                        <div class="write_table_div2">
                            <input type="text" id="startterm" name="startterm" value="" onKeyup="this.value=this.value.replace(/[^[0-9]/g, '');" maxlength="6">
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="message_table_div">
                        <div class="message_table_div1">
                        
                        </div>
                        <div class="message_table_div2">
                            <span id="starttermMessage">※ 시작월(yyyymm)을 입력해주세요.</span>
                        </div>
                        <div class="message_table_div3">
                        
                        </div>
                    </div>
                    <div class="write_table_div">
                        <div class="write_table_div1">
                            <span>종료월</span>
                        </div>
                        <div class="write_table_div2">
                            <input type="text" id="endterm" name="endterm" value="" onKeyup="this.value=this.value.replace(/[^[0-9]/g, '');" maxlength="6">
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="message_table_div">
                        <div class="message_table_div1">
                        
                        </div>
                        <div class="message_table_div2">
                            <span id="endtermMessage">※ 종료월(yyyymm)을 입력해주세요.</span>
                        </div>
                        <div class="message_table_div3">
                        
                        </div>
                    </div>
                    <div class="write_table_div">
                        <div class="write_table_div1">
                            <span>이미지 등록</span>
                        </div>
                        <div class="write_table_div2_upload">
                            <input type="file" id="imagefile" name="imagefile"/>
                            <div class="resizeBtnDiv">
                                <input type="button" id="resizeBtn" class="resizeBtn" value="이미지 편집"/>
                            </div>  
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="message_table_div">
                        <div class="message_table_div1">
                        
                        </div>
                        <div class="message_table_div2">
                            <span id="imageMessage">※ 사진을 등록해주세요. (권장 사이즈 : 150 x 250 px)</span>
                        </div>
                        <div class="message_table_div3">
                        
                        </div>
                    </div>
                    <div class="write_table_div">
                        <div class="write_table_div1">
                            <span>공개/비공개</span>
                        </div>
                        <div class="write_table_div2_option">
                            <select name="hiddenYN" title="hiddenYN">
                                <option value="N">공개</option>
                                <option value="Y">비공개</option>
                            </select>
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="message_table_div">
                        <div class="message_table_div1">
                        
                        </div>
                        <div class="message_table_div2">
                            <span></span>
                        </div>
                        <div class="message_table_div3">
                        
                        </div>
                    </div>
                    <div class="write_table_div" style="display: none;">
                        <div class="write_table_div1">
                            <span>작성자명</span>
                        </div>
                        <div class="write_table_div2">
                            <input type="text" name="writer" value="<%= loginMember.name %>">
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="write_table_div" style="display: none;">
                        <div class="write_table_div1">
                            <span>작성일</span>
                        </div>
                        <div class="write_table_div2">
                            <input type="text" id="date" name="date" value="">
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="write_table_btn">
                        <input type="submit" value="등록"/>
                        <a href="/admin/portfolio">
                            <span>돌아가기</span>
                        </a>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
<script>
// 필수사항 입력 체크 함수
function contentsCheck() {
    var customer = $('#customer').val();
    var project = $('#project').val();
    var startterm = $('#startterm').val();
    var endterm = $('#endterm').val()
    if(customer == "" || project == "" || startterm == "" || endterm == "" || $('#imagefile')[0].files.length === 0) {
        alert('필수항목을 입력해주세요.');
        return false;
    }
}    

$(function() {
    $(function init() {    
        // 작성일 오늘 날짜 자동기입
        $('#date').attr('value', todayDate());

        // 월 포매터 적용
        $('#startterm').change(function() {
            var $this =  $('#startterm').val();
            var formatmonth = monthformat($this);
            $('#startterm').val(formatmonth);
        });
        $('#endterm').change(function() {
            var $this =  $('#endterm').val();
            var formatmonth = monthformat($this);
            $('#endterm').val(formatmonth);
        });

        // 데이터 유무에 따른 알림 메시지 공개/비공개
        $('#customer').change(function() {
            if($('#customer').val() != "") {
                $('#customerMessage').css('display', 'none');
            }else {
                $('#customerMessage').css('display', 'block');
            }
        });     
        $('#project').change(function() {
            if($('#project').val() != "") {
                $('#projectMessage').css('display', 'none');
            }else {
                $('#projectMessage').css('display', 'block');
            }
        });  
        $('#startterm').change(function() {
            if($('#startterm').val() != "") {
                $('#starttermMessage').css('display', 'none');
            }else {
                $('#starttermMessage').css('display', 'block');
            }
        });  
        $('#endterm').change(function() {
            if($('#endterm').val() != "") {
                $('#endtermMessage').css('display', 'none');
            }else {
                $('#endtermMessage').css('display', 'block');
            }
        });
        $('#imagefile').change(function() {
            if($('#imagefile')[0].files.length != 0) {
                $('#imageMessage').css('display', 'none');
            }else {
                $('#imageMessage').css('display', 'block');
            }
        });         

        // 이미지 편집기 실행
        $('#resizeBtn').on('click', function() {
            window.open("/admin/imageeditor", "이미지 편집화면", "width=1070, height=530, top=0, left=0 overflow=hidden");
        });
    });
});    
</script>
<%- include('../../common/adminfooter.ejs') %>