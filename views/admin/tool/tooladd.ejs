<%- include('../../common/adminheader.ejs') %>
<script type="text/javascript" src="/node_modules/jquery/dist/jquery.js"></script>
<script type="text/javascript" src="/node_modules/xlsx/dist/xlsx.full.min.js"></script>
<title>관리장비 추가 페이지 - 테스트용 사이트</title>

<div class="admin_body">
    <div class="admin_content">
        <div class="admin_contentwrap">
            <h1>관리장비 추가</h1>          
            <form method="POST" enctype="multipart/form-data", action="/tool_create" onsubmit="return contentsCheck();">
                <div class="write_table">
                    <div class="write_table_div">
                        <div class="write_table_div1">
                            <span>유형</span>
                        </div>
                        <div class="write_table_div2_option">
                            <select name="productType" id="productType" title="productType">
                                <% 
                                for(var i = 0; i < codeList.length; i++) {
                                    if(codeList[i].codeName == "장비유형") {
                                        for(var j = 0; j < codeList[i].codeOption.length; j++) {                           
                                %>
                                <option value="<%= codeList[i].codeOption[j] %>"><%= codeList[i].codeOption[j] %></option>                          
                                <%  
                                        }
                                    }
                                }
                                %> 
                            </select>
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="message_table_div">
                        <div class="message_table_div1">
                        
                        </div>
                        <div class="message_table_div2">
                            <span></span>
                        </div>
                        <div class="message_table_div3">
                        
                        </div>
                    </div>
                    <div class="write_table_div">
                        <div class="write_table_div1">
                            <span>관리번호</span>
                        </div>
                        <div class="write_table_div2">
                            <input type="text" id="managementNumber" name="managementNumber" value="" maxlength="8">
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="message_table_div">
                        <div class="message_table_div1">
                        
                        </div>
                        <div class="message_table_div2">
                            <span id="managementNumberMessage">※ 관리번호를 입력해주세요. (예시: A0000, AA0000, A0000000)</span>
                        </div>
                        <div class="message_table_div3">
                        
                        </div>
                    </div>
                    <div class="write_table_div" id="selectColumn1_1">
                        <div class="write_table_div1">
                            <span>제조사</span>
                        </div>
                        <div class="write_table_div2_option">
                            <select name="maker" title="maker" id="maker">
                                <% 
                                for(var i = 0; i < codeList.length; i++) {
                                    if(codeList[i].codeName == "제조사") {
                                        for(var j = 0; j < codeList[i].codeOption.length; j++) {                           
                                %>
                                <option value="<%= codeList[i].codeOption[j] %>"><%= codeList[i].codeOption[j] %></option>                          
                                <%  
                                        }
                                    }
                                }
                                %> 
                            </select>
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="message_table_div" id="selectColumn1_2">
                        <div class="message_table_div1">
                        
                        </div>
                        <div class="message_table_div2">
                            <span></span>
                        </div>
                        <div class="message_table_div3">
                        
                        </div>
                    </div>
                    <div class="write_table_div" id="selectColumn2_1" style="display: none;">
                        <div class="write_table_div1">
                            <span>통신사</span>
                        </div>
                        <div class="write_table_div2_option">
                            <select name="telecom" title="telecom" id="telecom">
                                <option value="">선택</option>
                                <% 
                                for(var i = 0; i < codeList.length; i++) {
                                    if(codeList[i].codeName == "통신사") {
                                        for(var j = 0; j < codeList[i].codeOption.length; j++) {                           
                                %>
                                <option value="<%= codeList[i].codeOption[j] %>"><%= codeList[i].codeOption[j] %></option>                          
                                <%  
                                        }
                                    }
                                }
                                %> 
                            </select>
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="message_table_div" id="selectColumn2_2" style="display: none;">
                        <div class="message_table_div1">
                        
                        </div>
                        <div class="message_table_div2">
                            <span></span>
                        </div>
                        <div class="message_table_div3">
                        
                        </div>
                    </div>
                    <div class="write_table_div">
                        <div class="write_table_div1">
                            <span>제품명</span>
                        </div>
                        <div class="write_table_div2">
                            <input type="text" id="productName" name="productName" value="">
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="message_table_div">
                        <div class="message_table_div1">
                        
                        </div>
                        <div class="message_table_div2">
                            <span id="productNameMessage">※ 제품명을 입력해주세요.</span>
                        </div>
                        <div class="message_table_div3">
                        
                        </div>
                    </div>
                    <div class="write_table_div" id="selectColumn3_1">
                        <div class="write_table_div1">
                            <span>화면크기</span>
                        </div>
                        <div class="write_table_div2">
                            <input type="text" id="inch" name="inch" value="">
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="message_table_div" id="selectColumn3_2">
                        <div class="message_table_div1">
                        
                        </div>
                        <div class="message_table_div2">
                            <span id="inchMessage">※ 화면크기를 입력해주세요.</span>
                        </div>
                        <div class="message_table_div3">
                        
                        </div>
                    </div>
                    <div class="write_table_div" id="selectColumn4_1">
                        <div class="write_table_div1">
                            <span>CPU</span>
                        </div>
                        <div class="write_table_div2">
                            <input type="text" id="cpu" name="cpu" value="">
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="message_table_div" id="selectColumn4_2">
                        <div class="message_table_div1">
                        
                        </div>
                        <div class="message_table_div2">
                            <span id="cpuMessage">※ CPU를 입력해주세요.</span>
                        </div>
                        <div class="message_table_div3">
                        
                        </div>
                    </div>
                    <div class="write_table_div" id="selectColumn5_1">
                        <div class="write_table_div1">
                            <span>메모리</span>
                        </div>
                        <div class="write_table_div2">
                            <input type="text" id="memory" name="memory" value="">
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="message_table_div" id="selectColumn5_2">
                        <div class="message_table_div1">
                        
                        </div>
                        <div class="message_table_div2">
                            <span id="memoryMessage">※ 메모리를 입력해주세요.</span>
                        </div>
                        <div class="message_table_div3">
                        
                        </div>
                    </div>
                    <div class="write_table_div" id="selectColumn6_1">
                        <div class="write_table_div1">
                            <span>윈도우 유무</span>
                        </div>
                        <div class="write_table_div2">
                            <input type="text" id="windowYN" name="windowYN" value="">
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="message_table_div" id="selectColumn6_2">
                        <div class="message_table_div1">
                        
                        </div>
                        <div class="message_table_div2">
                            <span id="windowYNMessage">※ 윈도우 유무를 입력해주세요.</span>
                        </div>
                        <div class="message_table_div3">
                        
                        </div>
                    </div>
                    <div class="write_table_div" id="selectColumn7_1" style="display: none;">
                        <div class="write_table_div1">
                            <span>연결타입</span>
                        </div>
                        <div class="write_table_div2">
                            <input type="text" id="connectionType" name="connectionType" value="">
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="message_table_div" id="selectColumn7_2" style="display: none;">
                        <div class="message_table_div1">
                        
                        </div>
                        <div class="message_table_div2">
                            <span></span>
                        </div>
                        <div class="message_table_div3">
                        
                        </div>
                    </div>
                    <div class="write_table_div" id="selectColumn8_1" style="display: none;">
                        <div class="write_table_div1">
                            <span>LAN 지원유무</span>
                        </div>
                        <div class="write_table_div2_option">
                            <select name="lanYN" title="lanYN" id="lanYN">
                                <option value="Y">지원</option>
                                <option value="N">미지원</option>
                            </select>
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="message_table_div" id="selectColumn8_2" style="display: none;">
                        <div class="message_table_div1">
                        
                        </div>
                        <div class="message_table_div2">
                            <span></span>
                        </div>
                        <div class="message_table_div3">
                        
                        </div>
                    </div>
                    <div class="write_table_div">
                        <div class="write_table_div1">
                            <span>시리얼 번호</span>
                        </div>
                        <div class="write_table_div2">
                            <input type="text" id="productSerial" name="productSerial" value="">
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="message_table_div">
                        <div class="message_table_div1">
                        
                        </div>
                        <div class="message_table_div2">
                            <span></span>
                        </div>
                        <div class="message_table_div3">
                        
                        </div>
                    </div>
                    <div class="write_table_div" id="selectColumn9_1" style="display: none;">
                        <div class="write_table_div1">
                            <span>UDID(iPhone Only)</span>
                        </div>
                        <div class="write_table_div2">
                            <input type="text" id="udid" name="udid" value="">
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="message_table_div" id="selectColumn9_2" style="display: none;">
                        <div class="message_table_div1">
                        
                        </div>
                        <div class="message_table_div2">
                            <span></span>
                        </div>
                        <div class="message_table_div3">
                        
                        </div>
                    </div>
                    <div class="write_table_div" id="selectColumn10_1" style="display: none;">
                        <div class="write_table_div1">
                            <span>OS Version</span>
                        </div>
                        <div class="write_table_div2">
                            <input type="text" id="osVersion" name="osVersion" value="">
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="message_table_div" id="selectColumn10_2" style="display: none;">
                        <div class="message_table_div1">
                        
                        </div>
                        <div class="message_table_div2">
                            <span></span>
                        </div>
                        <div class="message_table_div3">
                        
                        </div>
                    </div>
                    <div class="write_table_div" id="selectColumn11_1" style="display: none;">
                        <div class="write_table_div1">
                            <span>개통번호</span>
                        </div>
                        <div class="write_table_div2">
                            <input type="text" id="phoneNumber" name="phoneNumber" value="" onKeyup="this.value=this.value.replace(/[^[0-9]/g, '');" maxlength="11">
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="message_table_div" id="selectColumn11_2" style="display: none;">
                        <div class="message_table_div1">
                        
                        </div>
                        <div class="message_table_div2">
                            <span></span>
                        </div>
                        <div class="message_table_div3">
                        
                        </div>
                    </div>
                    <div class="write_table_div" id="selectColumn12_1" style="display: none;">
                        <div class="write_table_div1">
                            <span>요금제 및 데이터</span>
                        </div>
                        <div class="write_table_div2">
                            <input type="text" id="callingPlan" name="callingPlan" value="">
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="message_table_div" id="selectColumn12_2" style="display: none;">
                        <div class="message_table_div1">
                        
                        </div>
                        <div class="message_table_div2">
                            <span></span>
                        </div>
                        <div class="message_table_div3">
                        
                        </div>
                    </div>
                    <div class="write_table_div">
                        <div class="write_table_div1">
                            <span>구매일</span>
                        </div>
                        <div class="write_table_div2">
                            <input type="text" id="purchaseDate" name="purchaseDate" value="" onKeyup="this.value=this.value.replace(/[^[0-9]/g, '');" maxlength="8">
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="message_table_div">
                        <div class="message_table_div1">
                        
                        </div>
                        <div class="message_table_div2">
                            <span></span>
                        </div>
                        <div class="message_table_div3">
                        
                        </div>
                    </div>
                    <div class="write_table_div">
                        <div class="write_table_div1">
                            <span>사용자</span>
                        </div>
                        <div class="write_table_div2">
                            <input type="text" id="user" name="user" value="">
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="message_table_div">
                        <div class="message_table_div1">
                        
                        </div>
                        <div class="message_table_div2">
                            <span></span>
                        </div>
                        <div class="message_table_div3">
                        
                        </div>
                    </div>
                    <div class="write_table_div">
                        <div class="write_table_div1">
                            <span>사용처</span>
                        </div>
                        <div class="write_table_div2_option">
                            <select name="usePlace" title="usePlace" id="usePlace">
                                <% 
                                for(var i = 0; i < codeList.length; i++) {
                                    if(codeList[i].codeName == "사용처") {
                                        for(var j = 0; j < codeList[i].codeOption.length; j++) {                           
                                %>
                                <option value="<%= codeList[i].codeOption[j] %>"><%= codeList[i].codeOption[j] %></option>                          
                                <%  
                                        }
                                    }
                                }
                                %> 
                            </select>
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="message_table_div">
                        <div class="message_table_div1">
                        
                        </div>
                        <div class="message_table_div2">
                            <span></span>
                        </div>
                        <div class="message_table_div3">
                        
                        </div>
                    </div>
                    <div class="write_table_div">
                        <div class="write_table_div1">
                            <span>이미지 등록</span>
                        </div>
                        <div class="write_table_div2_upload">
                            <input type="file" id="imagefile" name="imagefile"/>
                            <div class="resizeBtnDiv">
                                <input type="button" id="resizeBtn" class="resizeBtn" value="이미지 편집"/>
                            </div>                
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="message_table_div">
                        <div class="message_table_div1">
                        
                        </div>
                        <div class="message_table_div2">
                            <span id="imageMessage">※ 사진을 등록해주세요. (권장 사이즈 : 150 x 250 px)</span>
                        </div>
                        <div class="message_table_div3">
                        
                        </div>
                    </div>
                    <div class="write_table_div">
                        <div class="write_table_div1">
                            <span>비고</span>
                        </div>
                        <div class="write_table_div2">
                            <input type="text" id="reference" name="reference" value="">
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="message_table_div">
                        <div class="message_table_div1">
                        
                        </div>
                        <div class="message_table_div2">
                            <span></span>
                        </div>
                        <div class="message_table_div3">
                        
                        </div>
                    </div>
                    <div class="write_table_div" style="display: none;">
                        <div class="write_table_div1">
                            <span>작성자명</span>
                        </div>
                        <div class="write_table_div2">
                            <input type="text" name="writer" value="<%= loginMember.name %>">
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="write_table_div" style="display: none;">
                        <div class="write_table_div1">
                            <span>작성일</span>
                        </div>
                        <div class="write_table_div2">
                            <input type="text" name="date" id="date" value="">
                        </div>
                        <div class="write_table_div3">
                            
                        </div>
                    </div>
                    <div class="write_table_btn">
                        <input type="submit" value="등록"/>
                        <a id="excel_uploadBtn" href="javascript:void(0);">
                            <span>엑셀 업로드</span>
                        </a>
                        <input type="file" id="excel_upload" style="display: none;">
                        <a href="/admin/tool">
                            <span>돌아가기</span>
                        </a>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
<script>
// 필수사항 입력 체크 함수    
function contentsCheck() {
    if($('#managementNumber').val() == "" || $('#productName').val() == "") {
        alert('필수항목을 입력해주세요.');
        return false;
    }
}

$(function() {
    $(function init() {
        // 작성일 오늘 날짜 자동기입
        $('#date').attr('value', todayDate());

        // 관리번호 플래터 적용
        $('#managementNumber').change(function() {
            var $this =  $('#managementNumber').val();
            var formatnumber = manageformat($this);
            $('#managementNumber').val(formatnumber);
        });
        // 핸드폰 번호 플래터 적용
        $('#phoneNumber').change(function() {
            var $this =  $('#phoneNumber').val();
            var formatphone = phoneFormatter($this);
            $('#phoneNumber').val(formatphone);
        });
        // 날짜 플래터 적용
        $('#purchaseDate').change(function() {
            var $this =  $('#purchaseDate').val();
            var formatdate = dayformat($this);
            $('#purchaseDate').val(formatdate);
        });

        // 데이터 유무에 따른 알림 메시지 공개/비공개
        $('#managementNumber').change(function() {
            if($('#managementNumber').val() != "") {
                $('#managementNumberMessage').css('display', 'none');
            }else {
                $('#managementNumberMessage').css('display', 'block');
            }
        });   
        $('#productName').change(function() {
            if($('#productName').val() != "") {
                $('#productNameMessage').css('display', 'none');
            }else {
                $('#productNameMessage').css('display', 'block');
            }
        });   
        $('#inch').change(function() {
            if($('#inch').val() != "") {
                $('#inchMessage').css('display', 'none');
            }else {
                $('#inchMessage').css('display', 'block');
            }
        });   
        $('#cpu').change(function() {
            if($('#cpu').val() != "") {
                $('#cpuMessage').css('display', 'none');
            }else {
                $('#cpuMessage').css('display', 'block');
            }
        });  
        $('#memory').change(function() {
            if($('#memory').val() != "") {
                $('#memoryMessage').css('display', 'none');
            }else {
                $('#memoryMessage').css('display', 'block');
            }
        }); 
        $('#windowYN').change(function() {
            if($('#windowYN').val() != "") {
                $('#windowYNMessage').css('display', 'none');
            }else {
                $('#windowYNMessage').css('display', 'block');
            }
        });   
        $('#imagefile').change(function() {
            if($('#imagefile')[0].files.length != 0) {
                $('#imageMessage').css('display', 'none');
            }else {
                $('#imageMessage').css('display', 'block');
            }
        });         
  
        var selectColumn1_1 = $('#selectColumn1_1');
        var selectColumn1_2 = $('#selectColumn1_2');
        var selectColumn2_1 = $('#selectColumn2_1');
        var selectColumn2_2 = $('#selectColumn2_2');
        var selectColumn3_1 = $('#selectColumn3_1');
        var selectColumn3_2 = $('#selectColumn3_2');
        var selectColumn4_1 = $('#selectColumn4_1');
        var selectColumn4_2 = $('#selectColumn4_2');
        var selectColumn5_1 = $('#selectColumn5_1');
        var selectColumn5_2 = $('#selectColumn5_2');
        var selectColumn6_1 = $('#selectColumn6_1');
        var selectColumn6_2 = $('#selectColumn6_2');
        var selectColumn7_1 = $('#selectColumn7_1');
        var selectColumn7_2 = $('#selectColumn7_2');
        var selectColumn8_1 = $('#selectColumn8_1');
        var selectColumn8_2 = $('#selectColumn8_2');
        var selectColumn9_1 = $('#selectColumn9_1');
        var selectColumn9_2 = $('#selectColumn9_2');
        var selectColumn10_1 = $('#selectColumn10_1');
        var selectColumn10_2 = $('#selectColumn10_2');
        var selectColumn11_1 = $('#selectColumn11_1');
        var selectColumn11_2 = $('#selectColumn11_2');
        var selectColumn12_1 = $('#selectColumn12_1');
        var selectColumn12_2 = $('#selectColumn12_2');

        // 장비 유형에 따른 입력 컬럼 공개/비공개
        $('#productType').change(function() {
            if($('#productType').val() == "노트북") {
                selectColumn1_1.show();
                selectColumn1_2.show();
                selectColumn2_1.hide();
                selectColumn2_2.hide();
                selectColumn3_1.show();
                selectColumn3_2.show();          
                selectColumn4_1.show();
                selectColumn4_2.show();
                selectColumn5_1.show();
                selectColumn5_2.show();
                selectColumn6_1.show();
                selectColumn6_2.show();
                selectColumn7_1.hide();
                selectColumn7_2.hide();
                selectColumn8_1.hide();
                selectColumn8_2.hide();
                selectColumn9_1.hide();
                selectColumn9_2.hide();
                selectColumn10_1.hide();
                selectColumn10_2.hide();
                selectColumn11_1.hide();
                selectColumn11_2.hide();
                selectColumn12_1.hide();
                selectColumn12_2.hide();
            }else if($('#productType').val() == "모니터") {
                selectColumn1_1.show();
                selectColumn1_2.show();
                selectColumn2_1.hide();
                selectColumn2_2.hide();
                selectColumn3_1.show();
                selectColumn3_2.show();          
                selectColumn4_1.hide();
                selectColumn4_2.hide();
                selectColumn5_1.hide();
                selectColumn5_2.hide();
                selectColumn6_1.hide();
                selectColumn6_2.hide();
                selectColumn7_1.hide();
                selectColumn7_2.hide();
                selectColumn8_1.hide();
                selectColumn8_2.hide();
                selectColumn9_1.hide();
                selectColumn9_2.hide();
                selectColumn10_1.hide();
                selectColumn10_2.hide();
                selectColumn11_1.hide();
                selectColumn11_2.hide();
                selectColumn12_1.hide();
                selectColumn12_2.hide();
            }else if($('#productType').val() == "PC 본체") {
                selectColumn1_1.show();
                selectColumn1_2.show();
                selectColumn2_1.hide();
                selectColumn2_2.hide();
                selectColumn3_1.hide();
                selectColumn3_2.hide();          
                selectColumn4_1.show();
                selectColumn4_2.show();
                selectColumn5_1.show();
                selectColumn5_2.show();
                selectColumn6_1.show();
                selectColumn6_2.show();
                selectColumn7_1.hide();
                selectColumn7_2.hide();
                selectColumn8_1.hide();
                selectColumn8_2.hide();
                selectColumn9_1.hide();
                selectColumn9_2.hide();
                selectColumn10_1.hide();
                selectColumn10_2.hide();
                selectColumn11_1.hide();
                selectColumn11_2.hide();
                selectColumn12_1.hide();
                selectColumn12_2.hide();
            }else if($('#productType').val() == "RJ45 이더넷 어댑터") {
                selectColumn1_1.show();
                selectColumn1_2.show();
                selectColumn2_1.hide();
                selectColumn2_2.hide();
                selectColumn3_1.hide();
                selectColumn3_2.hide();          
                selectColumn4_1.hide();
                selectColumn4_2.hide();
                selectColumn5_1.hide();
                selectColumn5_2.hide();
                selectColumn6_1.hide();
                selectColumn6_2.hide();
                selectColumn7_1.show();
                selectColumn7_2.show();
                selectColumn8_1.show();
                selectColumn8_2.show();
                selectColumn9_1.hide();
                selectColumn9_2.hide();
                selectColumn10_1.hide();
                selectColumn10_2.hide();
                selectColumn11_1.hide();
                selectColumn11_2.hide();
                selectColumn12_1.hide();
                selectColumn12_2.hide();
            }else if($('#productType').val() == "테스트 단말기") {
                selectColumn1_1.show();
                selectColumn1_2.show();
                selectColumn2_1.hide();
                selectColumn2_2.hide();
                selectColumn3_1.hide();
                selectColumn3_2.hide();          
                selectColumn4_1.hide();
                selectColumn4_2.hide();
                selectColumn5_1.hide();
                selectColumn5_2.hide();
                selectColumn6_1.hide();
                selectColumn6_2.hide();
                selectColumn7_1.hide();
                selectColumn7_2.hide();
                selectColumn8_1.hide();
                selectColumn8_2.hide();
                selectColumn9_1.show();
                selectColumn9_2.show();
                selectColumn10_1.show();
                selectColumn10_2.show();
                selectColumn11_1.hide();
                selectColumn11_2.hide();
                selectColumn12_1.hide();
                selectColumn12_2.hide();
            }else if($('#productType').val() == "USB HUB") {
                selectColumn1_1.show();
                selectColumn1_2.show();
                selectColumn2_1.hide();
                selectColumn2_2.hide();
                selectColumn3_1.hide();
                selectColumn3_2.hide();          
                selectColumn4_1.hide();
                selectColumn4_2.hide();
                selectColumn5_1.hide();
                selectColumn5_2.hide();
                selectColumn6_1.hide();
                selectColumn6_2.hide();
                selectColumn7_1.show();
                selectColumn7_2.show();
                selectColumn8_1.show();
                selectColumn8_2.show();
                selectColumn9_1.hide();
                selectColumn9_2.hide();
                selectColumn10_1.hide();
                selectColumn10_2.hide();
                selectColumn11_1.hide();
                selectColumn11_2.hide();
                selectColumn12_1.hide();
                selectColumn12_2.hide();
            }else if($('#productType').val() == "USIM") {
                selectColumn1_1.hide();
                selectColumn1_2.hide();
                selectColumn2_1.show();
                selectColumn2_2.show();
                selectColumn3_1.hide();
                selectColumn3_2.hide();          
                selectColumn4_1.hide();
                selectColumn4_2.hide();
                selectColumn5_1.hide();
                selectColumn5_2.hide();
                selectColumn6_1.hide();
                selectColumn6_2.hide();
                selectColumn7_1.hide();
                selectColumn7_2.hide();
                selectColumn8_1.hide();
                selectColumn8_2.hide();
                selectColumn9_1.hide();
                selectColumn9_2.hide();
                selectColumn10_1.hide();
                selectColumn10_2.hide();
                selectColumn11_1.show();
                selectColumn11_2.show();
                selectColumn12_1.show();
                selectColumn12_2.show();
            }else if($('#productType').val() == "EGG") {
                selectColumn1_1.hide();
                selectColumn1_2.hide();
                selectColumn2_1.show();
                selectColumn2_2.show();
                selectColumn3_1.hide();
                selectColumn3_2.hide();          
                selectColumn4_1.hide();
                selectColumn4_2.hide();
                selectColumn5_1.hide();
                selectColumn5_2.hide();
                selectColumn6_1.hide();
                selectColumn6_2.hide();
                selectColumn7_1.hide();
                selectColumn7_2.hide();
                selectColumn8_1.hide();
                selectColumn8_2.hide();
                selectColumn9_1.hide();
                selectColumn9_2.hide();
                selectColumn10_1.hide();
                selectColumn10_2.hide();
                selectColumn11_1.hide();
                selectColumn11_2.hide();
                selectColumn12_1.show();
                selectColumn12_2.show();
            }
        });

        // 이미지 편집기 실행
        $('#resizeBtn').on('click', function() {
            window.open("/admin/imageeditor", "이미지 편집화면", "width=1070, height=530, top=0, left=0 overflow=hidden");
        });

        $('#excel_uploadBtn').on('click', function() {
            $('#excel_upload').trigger('click');
        });

        // 엑셀 업로드 함수
        function readExcel() {
            if($('#excel_upload')[0].files.length != 0) {
                let input = event.target;
                let reader = new FileReader();
                reader.onload = function () {
                    let data = reader.result;
                    let workBook = XLSX.read(data, { type: 'binary' });
                    workBook.SheetNames.forEach(function (sheetName) {
                        let rows = XLSX.utils.sheet_to_json(workBook.Sheets[sheetName]);
                        $('#productType').val(rows[0].유형).prop('selected', true);
                        $('#managementNumber').val(rows[0].관리번호);
                        $('#maker').val(rows[0].제조사).prop('selected', true);
                        $('#telecom').val(rows[0].통신사).prop('selected', true);
                        $('#productName').val(rows[0].제품명);
                        $('#inch').val(rows[0].화면크기);
                        $('#cpu').val(rows[0].cpu);
                        $('#memory').val(rows[0].메모리);
                        $('#windowYN').val(rows[0].윈도우유무);
                        $('#connectionType').val(rows[0].연결타입);
                        $('#lanYN').val(rows[0].LAN지원유무).prop('selected', true);
                        $('#productSerial').val(rows[0].시리얼);
                        $('#udid').val(rows[0].udid);
                        $('#osVersion').val(rows[0].osversion);
                        $('#phoneNumber').val(rows[0].개통번호);
                        $('#callingPlan').val(rows[0].요금제및데이터);
                        $('#purchaseDate').val(rows[0].구매일);
                        $('#user').val(rows[0].사용자);
                        $('#usePlace').val(rows[0].사용처).prop('selected', true);
                        $('#reference').val(rows[0].비고);
                    })
                };
                reader.readAsBinaryString(input.files[0]);
            }
        }

        $('#excel_upload').on('change', function() {
            if(confirm('입력칸에 엑셀파일을 업로드하시겠습니까?')) {
                readExcel();
                $('#excel_upload').val("");
            }    
        });
    });
});    
</script>
<%- include('../../common/adminfooter.ejs') %>